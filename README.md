# `json-diff`

*Take two Ruby objects that can be serialized to JSON. Output an array of operations (additions, deletions, moves) that would convert the first one to the second one.*

```bash
gem install json-diff  # Or `gem 'json-diff'` in your Gemfile.
```

```ruby
require 'json-diff'
JsonDiff.diff(1, 2)
#> [{:op => :replace, :path => "/", :value => 2}]
```

Outputs [RFC6902][]. Look at [hana][] for a JSON patch algorithm that can use this output.

[RFC6902]: http://www.rfc-editor.org/rfc/rfc6902.txt
[hana]: https://github.com/tenderlove/hana

# Heart

- Recursive similarity computation between any two Ruby values.
- For arrays, match elements above a certain level of similarity pairwise, and treat them as a move.
  - Matching happens highest-similarity first.
  - The creation of move operations is generated by detecting rings in the list of moved elements (eg, A → B → C → A).

Pros:

- For lists which are not necessarily ordered, this approach yields far better results than LCS.
- Move operations require no custom code to match elements.

Cons:

- This approach's quality is heavily reliant on how good the similarity algorithm is. Empirically, it yields sensible output. It can be improved by a user-defined procedure.
- There is a computational overhead to the default similarity computation that scales with the total number of entities in the structure.

# Plans & Bugs

Roughly ordered by priority.

- Support adding a custom procedure which computes similarities.
- Support LCS as an option. (The default will remain what yields the best results, regardless of the time it takes.)
- Support specifying a depth for similarity computation.

---

See the LICENSE file for licensing information.
